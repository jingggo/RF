*** Settings ***
Suite Setup       Login7thonline    ${URL}    ff    ${USER}    ${COMPANY}    ${EMPTY}    # ${browser_profile_ff_1}
Suite Teardown    #Close All Browsers
Force Tags        PH-Verify
Resource          ../../td_page_actions/style_bank_actions_res.txt
Resource          style_bank_test_data_ef.txt
Variables         style_bank_test_variables_ef.py
Resource          ../../td_page_actions/ph_styles_actions_res.txt
Variables         ph_verify_ef.py

*** Test Cases ***
Preparation for create ph color
    [Tags]
    [Template]    Create PH Color for preparation
    PH-AT-MA-030    ${PH_AT_VE_030}
    PH-AT-MA-033    ${PH_AT_VE_033}
    PH-AT-MA-035    ${PH_AT_VE_035}

Preparation for create ph style
    [Tags]
    [Template]    Copy on PH style page
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-MA-029    ${PH_AT_VE_029}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-MA-031    ${PH_AT_VE_031}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-MA-032    ${PH_AT_VE_032}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-MA-034    ${PH_AT_VE_034}

PH-Verify-1
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected

PH-Verify-2
    Click button    Verify Selected
    Wait until page does not contain element    ${please_wait_button}
    Wait until page contains    ErrorMessage
    Page should contain    [ER-30117] Please select the styles/colors you would like to verify.
    Click button    Back

PH-Verify-3
    Comment    Condition
    ${PH-AT-VE-001}    Set variable    PH-AT-VE-003
    ${season}    Set variable    SPRING
    ${year}    Set variable    2018
    ${non_exist_style}    Set variable    NONEXIST
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    Select from season and year dropdown    ${season}-${year}
    Input text    ${ph_search_style_path}    ${PH-AT-VE-001}
    Click button    Search
    Wait until page does not contain element    ${wait_button}
    Table column should contain    css=table.table1    2    ${PH-AT-VE-001}
    ${style_id}    Get value    //td[contains(text(),'${PH-AT-VE-001}')]/preceding-sibling::td/input
    Select checkbox    //input[@value='${style_id}']
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page    Check the page
    Wait until page contains    VerifyPlaceHolder
    Run keyword and continue on failure    Page should contain    If you verifying a placeholder color as well as placeholder styles, you will see your placeholder colors on the Match Colors page.
    Run keyword and continue on failure    Page should contain element    css=table.table1
    Run keyword and continue on failure    Table column should contain    css=table.table1    1    Placeholder #
    Run keyword and continue on failure    Table column should contain    css=table.table1    3    Matching EF Style
    Run keyword and continue on failure    Page should contain button    Match Colors
    Comment    Action on VerifyPlaceHolder page
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${non_exist_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Wait until page contains    ErrorMessage
    Page should contain    [ER-30145] Style NONEXIST does not exist in the system.
    Click button    Back
    Wait until page contains    VerifyPlaceHolder

PH-Verify-4
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-004
    ${ph_style_color_season_year}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2018
    ${ph_colors_info}    Create list    ${ph_style_color_season_year}
    ${matched_style}    Set variable    PH-AT-MA-004    #deleted style    001 BLACK - SPRING 2018
    ${matched_style_color_season_year1}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2018
    ${matched_colors_info}    Create list    ${matched_style_color_season_year1}
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_style_color_season_year['season']}-${ph_style_color_season_year['year']}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Wait until page contains    ErrorMessage
    Page should contain    [ER-30145] Style ${matched_style} does not exist in the system.
    Click button    Back
    Wait until page contains    VerifyPlaceHolder
    Comment    PH style will still exist in ph style page
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Go to advanced search on style bank
    Input text    id=Style    ${ph_style}
    Click button    Search
    Sleep    0.5
    Wait until page does not contain element    ${wait_button}
    Wait until page contains    Criteria:
    Table column should contain    css=table.table1    2    ${ph_style}

PH-Verify-5
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-005
    ${ph_style_color_season_year}    Create dictionary    color_code=002    color_name=WHITE    season=SPRING    year=2018
    ${ph_colors_info}    Create list    ${ph_style_color_season_year}
    ${matched_style}    Set variable    PH-AT-MA-005
    ${matched_style_color_season_year1}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2018
    Comment    ${matched_style_color_season_year2}    Create dictionary    color_code=002    color_name=WHITE    season=SPRING    year=2018
    ${matched_colors_info}    Create list    ${matched_style_color_season_year1}
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_style_color_season_year['season']}-${ph_style_color_season_year['year']}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Wait until page contains    MatchColors    #go to match colors page    choose match colors and season year
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}

PH-Verify-6
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-006    #001 BLACK - SPRING 2018
    ${ph_style_color_season_year}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2018
    ${ph_colors_info}    Create list    ${ph_style_color_season_year}
    ${matched_style}    Set variable    PH-AT-MA-006    #001 BLACK - SPRING 2018
    ${matched_style_color_season_year}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2018
    ${matched_colors_info}    Create list    ${matched_style_color_season_year}
    Comment    go to ph style page and click verify button
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_style_color_season_year['season']}-${ph_style_color_season_year['year']}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Wait until page contains    MatchColors    #go to match colors page    choose match colors and season year
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Verify on Thank you page
    Wait until page contains    ThankYou
    ${real_thank_you_style_color_info}    Create List    ${ph_style}    ${ph_style_color_season_year['color_code']}    ${ph_style_color_season_year['color_name']}    to    ${matched_style}
    ...    ${matched_style_color_season_year['color_code']}    ${matched_style_color_season_year['color_name']}
    Check thank you page after ph verified    ${real_thank_you_style_color_info}
    Comment    PH style will not exist in ph style page    no message to note you if you advanced search the unexist ph style    No placeholder styles found.
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Go to advanced search on style bank
    Input text    id=Style    ${ph_style}
    Click button    Search
    Sleep    0.5
    Wait until page does not contain element    ${wait_button}
    Wait until page contains    Criteria:
    List should have no selections    name=seasonandyear

PH-Verify-7
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-007    #001 BLACK - SPRING 2018
    ${ph_style_color_season_year}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2018
    ${ph_colors_info}    Create List    ${ph_style_color_season_year}
    ${matched_style}    Set variable    PH-AT-MA-007    #001 BLACK - SPRING 2018
    ${matched_style_color_season_year1}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2018
    ${matched_style_color_season_year2}    Create dictionary    color_code=002    color_name=WHITE    season=SPRING    year=2018
    ${matched_colors_info}    Create List    ${matched_style_color_season_year1}    ${matched_style_color_season_year2}
    Comment    Verify on UI
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_style_color_season_year['season']}-${ph_style_color_season_year['year']}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Wait until page contains    MatchColors    #go to match colors page    choose match colors and season year
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Verify on Thank you page
    Wait until page contains    ThankYou
    ${real_thank_you_style_color_info}    Create List    ${ph_style}    ${ph_style_color_season_year['color_code']}    ${ph_style_color_season_year['color_name']}    to    ${matched_style}
    ...    ${matched_style_color_season_year1['color_code']}    ${matched_style_color_season_year1['color_name']}
    Check thank you page after ph verified    ${real_thank_you_style_color_info}
    Comment    PH style will not exist in ph style page    no message to note you if you advanced search the unexist ph style
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Go to advanced search on style bank
    Input text    id=Style    ${ph_style}
    Click button    Search
    Sleep    0.5
    Wait until page does not contain element    ${wait_button}
    Wait until page contains    Criteria:
    List should have no selections    name=seasonandyear

PH-Verify-8
    [Documentation]    Only colors matched the season year would display on Match Colors page.
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-008    #001 BLACK - SPRING 2018
    ${ph_style_color_season_year}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2017
    ${ph_colors_info}    Create List    ${ph_style_color_season_year}
    ${matched_style}    Set variable    PH-AT-MA-008    #001 BLACK - SPRING 2018
    ${matched_style_color_season_year1}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2018
    ${matched_style_color_season_year2}    Create dictionary    color_code=002    color_name=WHITE    season=FALL    year=2018
    ${matched_style_color_season_year3}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2017
    ${matched_colors_info}    Create List    ${matched_style_color_season_year1}    ${matched_style_color_season_year2}    ${matched_style_color_season_year3}
    Comment    Verify on UI
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_style_color_season_year['season']}-${ph_style_color_season_year['year']}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Wait until page contains    MatchColors    #go to match colors page    choose match colors and season year
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Verify on Thank you page
    Wait until page contains    ThankYou
    ${real_thank_you_style_color_info}    Create List    ${ph_style}    ${ph_style_color_season_year['color_code']}    ${ph_style_color_season_year['color_name']}    to    ${matched_style}
    ...    ${matched_style_color_season_year1['color_code']}    ${matched_style_color_season_year1['color_name']}
    Check thank you page after ph verified    ${real_thank_you_style_color_info}
    Comment    PH style will not exist in ph style page    no message to note you if you advanced search the unexist ph style
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Go to advanced search on style bank
    Input text    id=Style    ${ph_style}
    Click button    Search
    Sleep    0.5
    Wait until page does not contain element    ${wait_button}
    Wait until page contains    Criteria:
    List should have no selections    name=seasonandyear

PH-Verify-9
    [Tags]
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-009    #001 BLACK - SPRING 2018
    Comment    ${ph_colors_info}    Set variable    ${PH_AT_VE_009}
    ${ph_style_color_season_year}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2018
    ${ph_colors_info}    Create List    ${ph_style_color_season_year}
    ${matched_style}    Set variable    PH-AT-MA-009    #001 BLACK - SPRING 2018
    Comment    ${matched_colors_info}    Set variable    ${PH_AT_MA_009}
    ${matched_style_color_season_year1}    Create dictionary    color_code=001    color_name=BLACK    season=FALL    year=2018
    ${matched_colors_info}    Create List    ${matched_style_color_season_year1}
    Comment    Verify on UI
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_style_color_season_year['season']}-${ph_style_color_season_year['year']}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Wait until page contains    MatchColors    #go to match colors page    choose match colors and season year
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Verify on Thank you page
    Wait until page contains    ThankYou
    ${real_thank_you_style_color_info}    Create List    ${ph_style}    ${ph_style_color_season_year['color_code']}    ${ph_style_color_season_year['color_name']}    to    ${matched_style}
    ...    ${matched_style_color_season_year1['color_code']}    ${matched_style_color_season_year1['color_name']}
    Check thank you page after ph verified    ${real_thank_you_style_color_info}
    Comment    PH style will not exist in ph style page    no message to note you if you advanced search the unexist ph style
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Go to advanced search on style bank
    Input text    id=Style    ${ph_style}
    Click button    Search
    Sleep    0.5
    Wait until page does not contain element    ${wait_button}
    Wait until page contains    Criteria:
    List should have no selections    name=seasonandyear

PH-Verify-10
    [Tags]
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-010    #001 BLACK - SPRING 2018
    ${ph_style_color_season_year}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2017
    ${ph_colors_info}    Create List    ${ph_style_color_season_year}
    ${matched_style}    Set variable    PH-AT-MA-010    #001 BLACK - SPRING 2018
    ${matched_style_color_season_year1}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2018
    ${matched_style_color_season_year2}    Create dictionary    color_code=004    color_name=BLUE    season=FALL    year=2018
    ${matched_style_color_season_year3}    Create dictionary    color_code=003    color_name=RED    season=SPRING    year=2018
    ${matched_style_color_season_year4}    Create dictionary    color_code=002    color_name=WHITE    season=FALL    year=2018
    ${matched_colors_info}    Create List    ${matched_style_color_season_year1}    ${matched_style_color_season_year2}    ${matched_style_color_season_year3}    ${matched_style_color_season_year4}    #mark sure order by color name
    Comment    Verify on UI
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_style_color_season_year['season']}-${ph_style_color_season_year['year']}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Wait until page contains    MatchColors    #go to match colors page    choose match colors and season year
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Verify on Thank you page
    Wait until page contains    ThankYou
    ${real_thank_you_style_color_info}    Create List    ${ph_style}    ${ph_style_color_season_year['color_code']}    ${ph_style_color_season_year['color_name']}    to    ${matched_style}
    ...    ${matched_style_color_season_year1['color_code']}    ${matched_style_color_season_year1['color_name']}
    Check thank you page after ph verified    ${real_thank_you_style_color_info}
    Comment    PH style will not exist in ph style page    no message to note you if you advanced search the unexist ph style
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Go to advanced search on style bank
    Input text    id=Style    ${ph_style}
    Click button    Search
    Sleep    0.5
    Wait until page does not contain element    ${wait_button}
    Wait until page contains    Criteria:
    List should have no selections    name=seasonandyear

PH-Verify-11
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-011    #001 BLACK - SPRING 2018
    ${ph_style_color_season_year}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2017
    ${ph_colors_info}    Create List    ${ph_style_color_season_year}
    ${matched_style}    Set variable    PH-AT-MA-011    #001 BLACK - SPRING 2018
    ${matched_style_color_season_year1}    Create dictionary    color_code=003    color_name=RED    season=FALL    year=2018
    ${matched_style_color_season_year2}    Create dictionary    color_code=002    color_name=WHITE    season=SPRING    year=2018
    ${matched_colors_info}    Create List    ${matched_style_color_season_year1}    ${matched_style_color_season_year2}    #mark sure order by color name
    Comment    Verify on UI
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_style_color_season_year['season']}-${ph_style_color_season_year['year']}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Wait until page contains    MatchColors    #go to match colors page    choose match colors and season year
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Verify on Thank you page
    Wait until page contains    ThankYou
    ${real_thank_you_style_color_info}    Create List    ${ph_style}    ${ph_style_color_season_year['color_code']}    ${ph_style_color_season_year['color_name']}    to    ${matched_style}
    ...    ${matched_style_color_season_year1['color_code']}    ${matched_style_color_season_year1['color_name']}
    Check thank you page after ph verified    ${real_thank_you_style_color_info}
    Comment    PH style will not exist in ph style page    no message to note you if you advanced search the unexist ph style
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Go to advanced search on style bank
    Input text    id=Style    ${ph_style}
    Click button    Search
    Sleep    0.5
    Wait until page does not contain element    ${wait_button}
    Wait until page contains    Criteria:
    List should have no selections    name=seasonandyear

PH-Verify-12
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-012    #001 BLACK - SPRING 2018
    ${ph_style_color_season_year}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2018
    ${ph_colors_info}    Create List    ${ph_style_color_season_year}
    ${matched_style}    Set variable    PH-AT-MA-012    #001 BLACK - SPRING 2018
    ${matched_style_color_season_year1}    Create dictionary    color_code=001    color_name=BLACK    season=SPRING    year=2018
    ${matched_colors_info}    Create List    ${matched_style_color_season_year1}    #mark sure order by color name
    Comment    Verify on UI
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_style_color_season_year['season']}-${ph_style_color_season_year['year']}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Verify on ErrorMessage page
    Wait until page contains    ErrorMessage
    Page should contain    [ER-30145] Style ${matched_style} does not exist in the system.
    Click button    Back
    Wait until page contains    VerifyPlaceHolder

PH-Verify-13
    [Documentation]    Remain as PH
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-013    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_013}
    ${matched_style}    Set variable    PH-AT-MA-013    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_013}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_013[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_013[0]}    year
    Comment    Verify on UI
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Select from list by label    //table[@class='table1']//tr[2]//select[@name='matchingstylecolorid']    Remain as PH
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Thanks you page info
    Thank you page PH verified as reamin as PH    ${ph_style}    ${ph_colors_info}

PH-Verify-14
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-014    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_014}
    ${matched_style}    Set variable    PH-AT-MA-014    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_014}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_014[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_014[0]}    year
    Comment    Verify on UI
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Select from list by label    //table[@class='table1']//tr[2]//select[@name='matchingstylecolorid']    Delete Color
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Thanks you page info
    Thank you page PH verified as Delete Color    ${ph_style}    ${ph_colors_info}

PH-Verify-15
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-015    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_015}
    ${matched_style}    Set variable    PH-AT-MA-015    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_015}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_015[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_015[0]}    year
    Comment    Verify on UI
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}

PH-Verify-16
    Copy on PH style page    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-016    ${PH_AT_VE_016}
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-016    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_016}
    ${matched_style}    Set variable    PH-AT-MA-016    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_016}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_016[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_016[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Comment
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Thanks you page info
    Thank you page PH verified    ${ph_style}    ${ph_colors_info}    ${matched_style}    ${matched_colors_info}
    Comment    ph style should not exist in ph page
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Go to advanced search on style bank
    Input text    id=Style    ${ph_style}
    Click button    Search
    Sleep    0.5
    Wait until page does not contain element    ${wait_button}
    Wait until page contains    Criteria:
    List should have no selections    name=seasonandyear
    Page should not contain element    css=table.table1

PH-Verify-17
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-017    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_017}
    ${matched_style}    Set variable    PH-AT-MA-017    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_017}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_017[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_017[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}

PH-Verify-18
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-018    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_018}
    ${matched_style}    Set variable    PH-AT-MA-018    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_018}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_018[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_018[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Comment
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    ErrorMessage page info
    Wait until page contains    ErrorMessage
    Page should contain    [ER-30124] You cannot match multiple placeholder style to the same style.
    Click button    Back
    Wait until page contains    MatchColors

PH-Verify-19
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-019    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_019}
    ${matched_style}    Set variable    PH-AT-MA-019    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_019}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_019[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_019[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Comment
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Thanks you page info
    Thank you page PH verified    ${ph_style}    ${ph_colors_info}    ${matched_style}    ${matched_colors_info}
    Comment    ph style should not exist in ph page
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Go to advanced search on style bank
    Input text    id=Style    ${ph_style}
    Click button    Search
    Sleep    0.5
    Wait until page does not contain element    ${wait_button}
    Wait until page contains    Criteria:
    List should have no selections    name=seasonandyear
    Page should not contain element    css=table.table1

PH-Verify-20
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-020    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_020}
    ${matched_style}    Set variable    PH-AT-MA-020    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_020}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_020[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_020[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Select from list by index    //table[@class='table1']//tr[2]//select[@name='matchingstylecolorid']    0
    Select from list by index    //table[@class='table1']//tr[3]//select[@name='matchingstylecolorid']    1
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Thanks you page info
    Thank you page PH verified    ${ph_style}    ${ph_colors_info}    ${matched_style}    ${matched_colors_info}
    Comment    ph style should not exist in ph page
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Go to advanced search on style bank
    Input text    id=Style    ${ph_style}
    Click button    Search
    Sleep    0.5
    Wait until page does not contain element    ${wait_button}
    Wait until page contains    Criteria:
    List should have no selections    name=seasonandyear
    Page should not contain element    css=table.table1

PH-Verify-21
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-021    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_021}
    ${matched_style}    Set variable    PH-AT-MA-021    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_021}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_021[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_021[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}

PH-Verify-22
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-022    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_022}
    ${matched_style}    Set variable    PH-AT-MA-022    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_022}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_022[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_022[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}

PH-Verify-23
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-023    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_023}
    ${matched_style}    Set variable    PH-AT-MA-023    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_023}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_023[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_023[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    : FOR    ${ph_color_info}    IN    @{ph_colors_info}
    \    ${ph_color_name}    Get from dictionary    ${ph_color_info}    color_name
    \    Select from list by label    //td[contains(text(),'${ph_color_name}')]/following-sibling::td/select[@name='matchingstylecolorid']    Remain as PH
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Thank you page PH verified as reamin as PH    ${ph_style}    ${ph_colors_info}

PH-Verify-24
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-024    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_024}
    ${matched_style}    Set variable    PH-AT-MA-024    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_024}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_024[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_024[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    : FOR    ${ph_color_info}    IN    @{ph_colors_info}
    \    ${ph_color_name}    Get from dictionary    ${ph_color_info}    color_name
    \    Continue for loop if    '${ph_color_name}'=='BLACK'
    \    Select from list by label    //td[contains(text(),'${ph_color_name}')]/following-sibling::td/select[@name='matchingstylecolorid']    Remain as PH
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Thanks you page info

PH-Verify-25
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-025    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_025}
    ${matched_style}    Set variable    PH-AT-MA-025    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_025}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_025[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_025[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    : FOR    ${ph_color_info}    IN    @{ph_colors_info}
    \    ${ph_color_name}    Get from dictionary    ${ph_color_info}    color_name
    \    Select from list by label    //td[contains(text(),'${ph_color_name}')]/following-sibling::td/select[@name='matchingstylecolorid']    Delete Color
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Thanks you page info
    Thank you page PH verified as Delete Color    ${ph_style}    ${ph_colors_info}

PH-Verify-26
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-026    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_026}
    ${matched_style}    Set variable    PH-AT-MA-026    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_026}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_026[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_026[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    : FOR    ${ph_color_info}    IN    @{ph_colors_info}
    \    ${ph_color_name}    Get from dictionary    ${ph_color_info}    color_name
    \    Continue for loop if    '${ph_color_name}'=='BLACK'
    \    Select from list by label    //td[contains(text(),'${ph_color_name}')]/following-sibling::td/select[@name='matchingstylecolorid']    Delete Color
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Thanks you page info
    Thank you page with PH verified and Delete    ${ph_style}    ${ph_colors_info}    ${matched_style}    ${matched_colors_info}

PH-Verify-27
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-027    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_027}
    ${matched_style}    Set variable    PH-AT-MA-027    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_027}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_027[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_027[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    : FOR    ${ph_color_info}    IN    @{ph_colors_info}
    \    ${ph_color_name}    Get from dictionary    ${ph_color_info}    color_name
    \    Continue for loop if    '${ph_color_name}'=='BLACK'
    \    Run keyword if    '${ph_color_name}'=='WHITE'    Select from list by label    //td[contains(text(),'${ph_color_name}')]/following-sibling::td/select[@name='matchingstylecolorid']    Remain as PH
    \    Run keyword if    '${ph_color_name}'=='RED'    Select from list by label    //td[contains(text(),'${ph_color_name}')]/following-sibling::td/select[@name='matchingstylecolorid']    Delete Color
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Thanks you page info
    Thank you page with PH verified and Delete    ${ph_style}    ${ph_colors_info}    ${matched_style}    ${matched_colors_info}

PH-Verify-28
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-VE-028    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_028}
    ${matched_style}    Set variable    PH-AT-MA-028    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_028}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_028[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_028[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Sleep    30
    : FOR    ${ph_color_info}    IN    @{ph_colors_info}
    \    ${ph_color_name}    Get from dictionary    ${ph_color_info}    color_name
    \    Run keyword if    '${ph_color_name}'=='WHITE'    Select from list by label    //td[contains(text(),'${ph_color_name}')]/following-sibling::td/select[@name='matchingstylecolorid']    Remain as PH
    \    Run keyword if    '${ph_color_name}'=='RED'    Select from list by label    //td[contains(text(),'${ph_color_name}')]/following-sibling::td/select[@name='matchingstylecolorid']    Delete Color
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Thanks you page info
    Comment    Thank you page with PH verified and Delete    ${ph_style}    ${ph_colors_info}    ${matched_style}    ${matched_colors_info}

PH-Verify-29
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-MA-029    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_029}
    ${matched_style}    Set variable    PH-AT-MA-029    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_029}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_029[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_029[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    : FOR    ${ph_color_info}    IN    @{ph_colors_info}
    \    ${ph_color_name}    Get from dictionary    ${ph_color_info}    color_name
    \    Run keyword if    '${ph_color_name}'=='WHITE'    Select from list by label    //td[contains(text(),'${ph_color_name}')]/following-sibling::td/select[@name='matchingstylecolorid']    Remain as PH
    \    Run keyword if    '${ph_color_name}'=='RED'    Select from list by label    //td[contains(text(),'${ph_color_name}')]/following-sibling::td/select[@name='matchingstylecolorid']    Delete Color
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Thanks you page info
    Wait until page contains    ThankYou    20
    Comment    Thank you page with PH verified and Delete    ${ph_style}    ${ph_colors_info}    ${matched_style}    ${matched_colors_info}
    Comment    PH color should disappear
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Select from season and year dropdown    ${ph_season}-${ph_year}
    Input text    ${ph_search_style_path}    ${ph_style}
    Click button    Search
    Wait until page does not contain element    ${wait_button}
    Comment    Table column should not contain    css=table.table1    2    ${ph_style}

PH-Verify-30
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-MA-030    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_030}
    ${matched_style}    Set variable    PH-AT-MA-030    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_030}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_030[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_030[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    Comment    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    ${style_colors_id}    Select ph color by search    ${ph_style}    ${ph_colors_info}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    MatchColors
    Check Match Colors page info for PH color    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Click button    Save
    Wait until page does not contain element    ${wait_button}
    Comment    Thanks you page info
    Wait until page contains    ThankYou    20
    Comment    Thank you page with PH verified and Delete    ${ph_style}    ${ph_colors_info}    ${matched_style}    ${matched_colors_info}
    Comment    PH color should disappear
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Select from season and year dropdown    ${ph_season}-${ph_year}
    Input text    ${ph_search_style_path}    ${ph_style}
    Click button    Search
    Wait until page does not contain element    ${wait_button}
    Run keyword and continue on failure    Page should contain    No placeholder styles found.
    Run keyword and continue on failure    Element should not contain    //form[@action='/bin-java/efsnPackage.do_vendorPlaceholderStyleListUpdate']    ${ph_style}

PH-Verify-31
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-MA-031    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_031}
    ${matched_style}    Set variable    PH-AT-MA-031    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_031}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_031[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_031[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Sleep    30

PH-Verify-32
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-MA-032    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_032}
    ${matched_style}    Set variable    PH-AT-MA-032    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_032}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_032[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_032[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Sleep    30

PH-Verify-33
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-MA-033    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_033}
    ${matched_style}    Set variable    PH-AT-MA-033    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_033}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_033[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_033[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_colors_id}    Select ph color by search    ${ph_style}    ${ph_colors_info}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    MatchColors
    Check Match Colors page info for PH color    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}

PH-Verify-34
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-MA-034    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_034}
    ${matched_style}    Set variable    PH-AT-MA-034    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_034}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_034[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_034[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_id}    Select ph style by search    ${ph_style}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    VerifyPlaceHolder
    Input text    //input[@value='${style_id}']/following-sibling::td/input[@name='matchingstylenum']    ${matched_style}
    Click button    Match Colors
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Check Match Colors page info for PH style    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}
    Sleep    30

PH-Verify-35
    Comment    Condition
    ${ph_style}    Set variable    PH-AT-MA-035    #001 BLACK - SPRING 2018
    ${ph_colors_info}    Set variable    ${PH_AT_VE_035}
    ${matched_style}    Set variable    PH-AT-MA-035    #001 BLACK - SPRING 2018
    ${matched_colors_info}    Set variable    ${PH_AT_MA_035}
    ${ph_season}    Get from dictionary    ${PH_AT_VE_035[0]}    season
    ${ph_year}    Get from dictionary    ${PH_AT_VE_035[0]}    year
    Comment
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain button    Verify Selected
    ${style_colors_id}    Select ph color by search    ${ph_style}    ${ph_colors_info}    ${ph_season}-${ph_year}
    Click button    Verify Selected
    Sleep    0.2
    Wait until page does not contain element    ${please_wait_button}
    Comment    Go to VerifyPlaceHolder page
    Wait until page contains    MatchColors
    Check Match Colors page info for PH color    ${ph_style}    ${matched_style}    ${ph_colors_info}    ${matched_colors_info}

temp
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-005    ${PH_AT_VE_005}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-006    ${PH_AT_VE_006}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-007    ${PH_AT_VE_007}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-008    ${PH_AT_VE_008}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-009    ${PH_AT_VE_009}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-010    ${PH_AT_VE_010}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-011    ${PH_AT_VE_011}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-012    ${PH_AT_VE_012}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-016    ${PH_AT_VE_016}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-017    ${PH_AT_VE_017}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-018    ${PH_AT_VE_018}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-019    ${PH_AT_VE_019}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-020    ${PH_AT_VE_020}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-021    ${PH_AT_VE_021}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-022    ${PH_AT_VE_022}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-023    ${PH_AT_VE_023}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-024    ${PH_AT_VE_024}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-025    ${PH_AT_VE_025}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-026    ${PH_AT_VE_026}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-027    ${PH_AT_VE_027}
    PH-AT-VE-004    ${PH_AT_VE_004[0]}    PH-AT-VE-028    ${PH_AT_VE_028}

*** Keywords ***
Check Match Colors page info for PH style
    [Arguments]    ${ph_style}    ${matched_style}    ${ph_colors_season_year}    ${matched_colors_season_year}
    Page should contain    MatchColors
    Comment    Placeholder #: PH-AT-VE-007    Matching EF Style: PH-AT-MA-006
    ${main_text}    Get text    //form[contains(@action,'do_vendorPlaceholderMatchColorUpdate')]
    ${main_texts}    Split to lines    ${main_text}
    ${ph_style_info}    Get from list    ${main_texts}    1
    ${ph_style_info}    Replace string    ${ph_style_info}    u'\xa0'    ${SPACE}
    Run keyword and continue on failure    Should be equal as strings    ${ph_style_info}    Placeholder #: ${ph_style}
    ${matched_style_info}    Get from list    ${main_texts}    2
    ${matched_style_info}    Replace string    ${matched_style_info}    u'\xa0'    ${SPACE}
    Run keyword and continue on failure    Should be equal as strings    ${matched_style_info}    Matching EF Style: ${matched_style}
    Comment    Table title and button
    Run keyword and continue on failure    Table row should contain    css=table.table1    1    Placeholder Color
    Run keyword and continue on failure    Table row should contain    css=table.table1    1    Matching Color Fashion Season-Year
    Run keyword and continue on failure    Page should contain button    Save
    Comment    verified colors and matching colors
    ${tr_count}    Get matching xpath count    //table[@class='table1']/tbody/tr
    ${tr_count}    Convert to integer    ${tr_count}
    ${verified_color_count}    Evaluate    ${tr_count} - 1
    ${real_verified_color_count}    Get length    ${ph_colors_season_year}
    Run keyword and continue on failure    Should be equal as integers    ${verified_color_count}    ${real_verified_color_count}
    ${some_ph_color_info}    Get from list    ${ph_colors_season_year}    0
    ${ph_season}    Get from dictionary    ${some_ph_color_info}    season    #the ph style colors' season and year are the same
    ${ph_year}    Get from dictionary    ${some_ph_color_info}    year
    ${real_matching_colors_items}    Create list
    ${real_unmatching_colors_items}    Create list
    : FOR    ${matched_colors_season_year}    IN    @{matched_colors_season_year}
    \    ${matched_color_code}    Get from dictionary    ${matched_colors_season_year}    color_code
    \    ${matched_color_name}    Get from dictionary    ${matched_colors_season_year}    color_name
    \    ${matched_color_season}    Get from dictionary    ${matched_colors_season_year}    season
    \    ${matched_color_year}    Get from dictionary    ${matched_colors_season_year}    year
    \    ${real_matching_colors_item}    Set variable    ${matched_color_code} ${matched_color_name} - ${matched_color_season} ${matched_color_year}
    \    ${is_season_year_matched}    Run keyword and return status    Should be equal as strings    ${ph_season}-${ph_year}    ${matched_color_season}-${matched_color_year}
    \    Run keyword if    ${is_season_year_matched}    Append to list    ${real_matching_colors_items}    ${real_matching_colors_item}
    \    Run keyword unless    ${is_season_year_matched}    Append to list    ${real_unmatching_colors_items}    ${real_matching_colors_item}
    ${real_matching_colors_items_len}    Get length    ${real_matching_colors_items}    #if length of matched items is 0, means no year season matched, then unmatched year season would dispaly
    ${real_colors_items_option}    Set variable if    ${real_matching_colors_items_len}==${0}    ${real_unmatching_colors_items}    ${real_matching_colors_items}
    Append to list    ${real_colors_items_option}    Remain as PH    Delete Color
    Log    ${real_colors_items_option}
    : FOR    ${i}    ${ph_color_season_year}    IN ENUMERATE    @{ph_colors_season_year}
    \    ${ph_color_code}    Get from dictionary    ${ph_color_season_year}    color_code
    \    ${ph_color_name}    Get from dictionary    ${ph_color_season_year}    color_name
    \    ${ph_color_season}    Get from dictionary    ${ph_color_season_year}    season
    \    ${ph_color_year}    Get from dictionary    ${ph_color_season_year}    year
    \    ${ph_color}    Get table cell    css=table.table1    ${i+2}    1    #&nbsp;001&nbsp;BLACK&nbsp;
    \    ${separater}    Get table cell    css=table.table1    ${i+2}    2    #&nbsp;<b>=</b>&nbsp;
    \    ${matched_color_season_year}    Get selected list label    //table[@class='table1']/tbody/tr[${i+2}]//select    #001&nbsp;BLACK - SPRING 2018&nbsp;
    \    ${ph_color}    Replace string    ${ph_color}    u'\xa0'    ${SPACE}
    \    ${separater}    Replace string    ${separater}    u'\xa0'    ${SPACE}
    \    ${matched_color_season_year}    Replace string    ${matched_color_season_year}    u'\xa0'    ${SPACE}
    \    Run keyword and continue on failure    Should be equal as strings    ${ph_color}    ${SPACE}${ph_color_code} ${ph_color_name}${SPACE}
    \    Run keyword and continue on failure    Should be equal as strings    ${separater}    ${SPACE}=${SPACE}
    \    ${matched_colors_items}    Get list items    //table[@class='table1']/tbody/tr[${i+2}]//select
    \    ${matched_colors_items}    Evaluate    [l.replace("&nbsp; ","${SPACE}") for l in ${matched_colors_items}]
    \    ${matched_colors_items}    Evaluate    [l.strip() for l in ${matched_colors_items}]
    \    Run keyword and continue on failure    Lists should be equal    ${matched_colors_items}    ${real_colors_items_option}    #colors with matched season year would display
    \    ${is_color_season_year_matched}    Run keyword and return status    List should contain value    ${matched_colors_items}    ${ph_color_code} ${ph_color_name} - ${ph_color_season} ${ph_color_year}
    \    Run keyword if    ${is_color_season_year_matched}    Run keyword and continue on failure    Should be equal as strings    ${matched_color_season_year}    ${ph_color_code} ${ph_color_name} - ${ph_color_season} ${ph_color_year}${SPACE}
    \    #not exactly know the order of list items, so if color of year season matched, script would check its default label. if not matched, script should ignore

Check Match Colors page info for PH color
    [Arguments]    ${ph_style}    ${matched_style}    ${ph_colors_season_year}    ${matched_colors_season_year}
    Page should contain    MatchColors
    Comment    Placeholder #: PH-AT-VE-007    Matching EF Style: PH-AT-MA-006
    ${main_text}    Get text    //form[contains(@action,'do_vendorPlaceholderMatchColorUpdate')]
    ${main_texts}    Split to lines    ${main_text}
    ${matched_style_info}    Get from list    ${main_texts}    1
    ${matched_style_info}    Replace string    ${matched_style_info}    u'\xa0'    ${SPACE}
    Run keyword and continue on failure    Should be equal as strings    ${matched_style_info}    Matching EF Style: ${matched_style}
    Comment    Table title and button
    Run keyword and continue on failure    Table row should contain    css=table.table1    1    Placeholder Color
    Run keyword and continue on failure    Table row should contain    css=table.table1    1    Matching Color Fashion Season-Year
    Run keyword and continue on failure    Page should contain button    Save
    Comment    verified colors and matching colors
    ${tr_count}    Get matching xpath count    //table[@class='table1']/tbody/tr
    ${tr_count}    Convert to integer    ${tr_count}
    ${verified_color_count}    Evaluate    ${tr_count} - 1
    ${real_verified_color_count}    Get length    ${ph_colors_season_year}
    Run keyword and continue on failure    Should be equal as integers    ${verified_color_count}    ${real_verified_color_count}
    ${some_ph_color_info}    Get from list    ${ph_colors_season_year}    0
    ${ph_season}    Get from dictionary    ${some_ph_color_info}    season    #the ph style colors' season and year are the same
    ${ph_year}    Get from dictionary    ${some_ph_color_info}    year
    ${real_matching_colors_items}    Create list
    ${real_unmatching_colors_items}    Create list
    :FOR    ${matched_colors_season_year}    IN    @{matched_colors_season_year}
    \    ${matched_color_code}    Get from dictionary    ${matched_colors_season_year}    color_code
    \    ${matched_color_name}    Get from dictionary    ${matched_colors_season_year}    color_name
    \    ${matched_color_season}    Get from dictionary    ${matched_colors_season_year}    season
    \    ${matched_color_year}    Get from dictionary    ${matched_colors_season_year}    year
    \    ${real_matching_colors_item}    Set variable    ${matched_color_code} ${matched_color_name} - ${matched_color_season} ${matched_color_year}
    \    ${is_season_year_matched}    Run keyword and return status    Should be equal as strings    ${ph_season}-${ph_year}    ${matched_color_season}-${matched_color_year}
    \    Run keyword if    ${is_season_year_matched}    Append to list    ${real_matching_colors_items}    ${real_matching_colors_item}
    \    Run keyword unless    ${is_season_year_matched}    Append to list    ${real_unmatching_colors_items}    ${real_matching_colors_item}
    ${real_matching_colors_items_len}    Get length    ${real_matching_colors_items}    #if length of matched items is 0, means no year season matched, then unmatched year season would dispaly
    ${real_colors_items_option}    Set variable if    ${real_matching_colors_items_len}==${0}    ${real_unmatching_colors_items}    ${real_matching_colors_items}
    Append to list    ${real_colors_items_option}    Remain as PH    Delete Color
    Log    ${real_colors_items_option}
    :FOR    ${i}    ${ph_color_season_year}    IN ENUMERATE    @{ph_colors_season_year}
    \    ${ph_color_code}    Get from dictionary    ${ph_color_season_year}    color_code
    \    ${ph_color_name}    Get from dictionary    ${ph_color_season_year}    color_name
    \    ${ph_color_season}    Get from dictionary    ${ph_color_season_year}    season
    \    ${ph_color_year}    Get from dictionary    ${ph_color_season_year}    year
    \    ${ph_color}    Get table cell    css=table.table1    ${i+2}    1    #&nbsp;001&nbsp;BLACK&nbsp;
    \    ${separater}    Get table cell    css=table.table1    ${i+2}    2    #&nbsp;<b>=</b>&nbsp;
    \    ${matched_color_season_year}    Get selected list label    //table[@class='table1']/tbody/tr[${i+2}]//select    #001&nbsp;BLACK - SPRING 2018&nbsp;
    \    ${ph_color}    Replace string    ${ph_color}    u'\xa0'    ${SPACE}
    \    ${separater}    Replace string    ${separater}    u'\xa0'    ${SPACE}
    \    ${matched_color_season_year}    Replace string    ${matched_color_season_year}    u'\xa0'    ${SPACE}
    \    Run keyword and continue on failure    Should be equal as strings    ${ph_color}    ${SPACE}${ph_color_code} ${ph_color_name}${SPACE}
    \    Run keyword and continue on failure    Should be equal as strings    ${separater}    ${SPACE}=${SPACE}
    \    ${matched_colors_items}    Get list items    //table[@class='table1']/tbody/tr[${i+2}]//select
    \    ${matched_colors_items}    Evaluate    [l.replace("&nbsp; ","${SPACE}") for l in ${matched_colors_items}]
    \    ${matched_colors_items}    Evaluate    [l.strip() for l in ${matched_colors_items}]
    \    Run keyword and continue on failure    Lists should be equal    ${matched_colors_items}    ${real_colors_items_option}    #colors with matched season year would display
    \    ${is_color_season_year_matched}    Run keyword and return status    List should contain value    ${matched_colors_items}    ${ph_color_code} ${ph_color_name} - ${ph_color_season} ${ph_color_year}
    \    Run keyword if    ${is_color_season_year_matched}    Run keyword and continue on failure    Should be equal as strings    ${matched_color_season_year}    ${ph_color_code} ${ph_color_name} - ${ph_color_season} ${ph_color_year}${SPACE}
    \    #not exactly know the order of list items, so if color of year season matched, script would check its default label. if not matched, script should ignore

Check thank you page after ph verified
    [Arguments]    ${real_thank_you_style_color_info}    # ${ph_style} | ${ph_color_code} | ${ph_color_name} | ${matched_style} | ${matched_color_code} | ${matched_color_name}
    Page should contain    The following placeholders were converted into styles:
    ${thank_page_titles}    Execute javascript    var result=[];$("div.notabcontent th").each(function(){result.push($(this).text()); });return result;
    ${thank_page_titles}    Evaluate    [l.strip(u'\xa0') for l in ${thank_page_titles}]
    ${expected_titles}    Create list    Placeholder #    Color Code    Color Description    ${EMPTY}    EF Style
    ...    Color Code    Color Description
    Run keyword and continue on failure    Lists should be equal    ${thank_page_titles}    ${expected_titles}
    ${thank_page_style_info}    Execute javascript    var result=[];$("div.notabcontent td").each(function(){result.push($(this).text()); });return result;
    ${thank_page_style_info}    Evaluate    [l.strip(u'\xa0') for l in ${thank_page_style_info}]
    Comment    ${real_thank_you_style_color_info}    Create list    ${ph_style}    ${ph_color_code}    ${ph_color_name}    to
    ...    ${matched_style}    ${matched_color_code}    ${matched_color_name}
    Run keyword and continue on failure    Lists should be equal    ${thank_page_style_info}    ${real_thank_you_style_color_info}
    #    [u'PH-AT-VE-006', u'001', u'BLACK', u'to', u'PH-AT-MA-006', u'001', u'BLACK']

Select ph style by search
    [Arguments]    ${ph_style}    ${season_year}
    Select from season and year dropdown    ${season_year}
    Input text    ${ph_search_style_path}    ${ph_style}
    Click button    Search
    Wait until page does not contain element    ${wait_button}
    Table column should contain    css=table.table1    2    ${ph_style}
    ${style_id}    Get value    //td[contains(text(),'${ph_style}')]/preceding-sibling::td/input
    Select checkbox    //input[@value='${style_id}']
    [Return]    ${style_id}

Thank you page PH verified
    [Arguments]    ${ph_style}    ${real_ph_colors_info}    ${matched_style}    ${matched_colors_info}
    Page should contain    The following placeholders were converted into styles:
    ${thank_page_titles}    Execute javascript    var result=[];$("div.notabcontent th").each(function(){result.push($(this).text()); });return result;
    ${thank_page_titles}    Evaluate    [l.strip(u'\xa0') for l in ${thank_page_titles}]
    ${expected_titles}    Create list    Placeholder #    Color Code    Color Description    ${EMPTY}    EF Style
    ...    Color Code    Color Description
    Run keyword and continue on failure    Lists should be equal    ${thank_page_titles}    ${expected_titles}
    ${thank_page_style_info}    Execute javascript    var result=[];$("div.notabcontent td").each(function(){result.push($(this).text()); });return result;
    ${thank_page_style_info}    Evaluate    [l.strip(u'\xa0') for l in ${thank_page_style_info}]    #    [u'PH-AT-VE-006', u'001', u'BLACK', u'to', u'PH-AT-MA-006', u'001', u'BLACK']
    ${thank_page_style_info_len}    Get length    ${thank_page_style_info}
    ${thank_page_style_info_rowx}    Evaluate    ${thank_page_style_info_len}/6    #6 items per row
    ${init}    Set variable    ${0}
    ${convert_style_infos}    Create List
    : FOR    ${rowx}    IN RANGE    ${thank_page_style_info_rowx}
    \    ${thank_page_style_info_row}    Get slice from list    ${thank_page_style_info}    ${init}    ${init+7}
    \    ${thank_page_style_info_row}    Evaluate    '-'.join(${thank_page_style_info_row})
    \    ${init}    Set variable    ${init+7}
    \    Append to list    ${convert_style_infos}    ${thank_page_style_info_row}
    Log    ${convert_style_infos}
    ${real_ph_colors}    Create list
    : FOR    ${real_ph_color_info}    ${matched_color_info}    IN ZIP    ${real_ph_colors_info}    ${matched_colors_info}
    \    ${ph_color_code}    Get from dictionary    ${real_ph_color_info}    color_code
    \    ${phl_color_name}    Get from dictionary    ${real_ph_color_info}    color_name
    \    ${real_color_code}    Get from dictionary    ${matched_color_info}    color_code
    \    ${real_color_name}    Get from dictionary    ${matched_color_info}    color_name
    \    ${real_color_info_row}    Catenate    SEPARATOR=-    ${ph_style}    ${ph_color_code}    ${phl_color_name}
    \    ...    to    ${matched_style}    ${real_color_code}    ${real_color_name}
    \    Append to list    ${real_ph_colors}    ${real_color_info_row}
    Log    ${real_ph_colors}
    Run keyword and continue on failure    Lists should be equal    ${convert_style_infos}    ${real_ph_colors}    Lists are wrong on ThankYou page.

Copy on PH style page
    [Arguments]    ${src_style}    ${src_color_season_year}    ${tar_style}    ${tar_colors_season_year}
    [Timeout]
    ${src_season}    Get from dictionary    ${src_color_season_year}    season
    ${src_year}    Get from dictionary    ${src_color_season_year}    year
    ${src_color_code}    Get from dictionary    ${src_color_season_year}    color_code
    ${src_color_name}    Get from dictionary    ${src_color_season_year}    color_name
    ${tar_color_season_year}    Get from list    ${tar_colors_season_year}    0
    ${tar_season}    Get from dictionary    ${tar_color_season_year}    season
    ${tar_year}    Get from dictionary    ${tar_color_season_year}    year
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Go to advanced search on style bank
    Input text    id=Style    ${tar_style}
    Click search button
    ${is_ph_style_exist}    Run keyword and return status    Table column should contain    css=table.table1    2    ${tar_style}
    Return from keyword if    ${is_ph_style_exist}
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    ${style_id}    Select ph style by search    ${src_style}    ${src_season}-${src_year}
    Click link    //a[contains(@href,'styleid=${style_id}') and text()='Copy']
    Sleep    0.2
    Wait until page contains    CopyToPlaceHolder    10
    Input text    name=stylenum    ${tar_style}
    Run keyword unless    '${src_season}'=='${tar_season}'    Select from list by label    name=seasonid    ${tar_season}
    Run keyword unless    '${src_year}'=='${tar_year}'    Select from list by label    id=year    ${tar_year}
    : FOR    ${i}    ${create_ph_color}    IN ENUMERATE    @{tar_colors_season_year}
    \    ${tar_color_code}    Get from dictionary    ${create_ph_color}    color_code
    \    ${tar_color_name}    Get from dictionary    ${create_ph_color}    color_name
    \    Run keyword unless    '${src_color_code}'=='${tar_color_code}'    Input text    //div[@class='DTFC_LeftBodyWrapper']//tbody/tr[${i+1}]/td[2]/input    ${tar_color_code}
    \    Run keyword unless    '${src_color_code}'=='${tar_color_code}'    Input text    //div[@class='dataTables_scroll']//table[@id='mt']//tbody/tr[${i+1}]//input[@name='nrfcolorcode']    ${EMPTY}
    \    Run keyword unless    '${src_color_name}'=='${tar_color_name}'    Input text    //div[@class='DTFC_LeftBodyWrapper']//tbody/tr[${i+1}]/td[3]/input    ${tar_color_name}
    Click button    Save Style Info
    Sleep    1
    Wait until page contains    PlaceHolderStyles

Thank you page with PH verified and Delete
    [Arguments]    ${ph_style}    ${real_ph_colors_info}    ${matched_style}    ${matched_colors_info}
    Page should contain    The following placeholders were converted into styles:
    ${thank_page_titles}    Execute javascript    var result=[];$("div.notabcontent th").each(function(){result.push($(this).text()); });return result;
    ${thank_page_titles}    Evaluate    [l.strip(u'\xa0') for l in ${thank_page_titles}]
    ${expected_titles}    Create list    Placeholder #    Color Code    Color Description    ${EMPTY}    EF Style
    ...    Color Code    Color Description
    Run keyword and continue on failure    Lists should be equal    ${thank_page_titles}    ${expected_titles}
    ${thank_page_style_info}    Execute javascript    var result=[];$("div.notabcontent td").each(function(){result.push($(this).text()); });return result;
    ${thank_page_style_info}    Evaluate    [l.strip(u'\xa0') for l in ${thank_page_style_info}]    #    [u'PH-AT-VE-006', u'001', u'BLACK', u'to', u'PH-AT-MA-006', u'001', u'BLACK']
    ${thank_page_style_info_len}    Get length    ${thank_page_style_info}
    ${thank_page_style_info_rowx}    Evaluate    ${thank_page_style_info_len}/6    #6 items per row
    ${init}    Set variable    ${0}
    ${convert_style_infos}    Create List
    : FOR    ${rowx}    IN RANGE    ${thank_page_style_info_rowx}
    \    ${thank_page_style_info_row}    Get slice from list    ${thank_page_style_info}    ${init}    ${init+7}
    \    ${thank_page_style_info_row}    Evaluate    '-'.join(${thank_page_style_info_row})
    \    ${init}    Set variable    ${init+7}
    \    Append to list    ${convert_style_infos}    ${thank_page_style_info_row}
    Log    ${convert_style_infos}
    ${real_ph_colors}    Create list
    : FOR    ${real_ph_color_info}    ${matched_color_info}    IN ZIP    ${real_ph_colors_info}    ${matched_colors_info}
    \    ${ph_color_code}    Get from dictionary    ${real_ph_color_info}    color_code
    \    ${phl_color_name}    Get from dictionary    ${real_ph_color_info}    color_name
    \    ${real_color_code}    Get from dictionary    ${matched_color_info}    color_code
    \    ${real_color_name}    Get from dictionary    ${matched_color_info}    color_name
    \    ${real_color_info_row}    Catenate    SEPARATOR=-    ${ph_style}    ${ph_color_code}    ${phl_color_name}
    \    ...    to    ${matched_style}    ${real_color_code}    ${real_color_name}
    \    Append to list    ${real_ph_colors}    ${real_color_info_row}
    Log    ${real_ph_colors}
    Run keyword and continue on failure    Lists should be equal    ${convert_style_infos}    ${real_ph_colors}    Lists are wrong on ThankYou page.

Create PH Color for preparation
    [Arguments]    ${style}    ${colors_season_year_info}
    ${style_number}    Set variable    ${style}
    ${season}    Get from dictionary    ${colors_season_year_info[0]}    season
    ${year}    Get from dictionary    ${colors_season_year_info[0]}    year
    Entry page via navimenu    ${navi_ph_styles_path}    PlaceHolderStyles
    Page should contain    PlaceHolderStyles
    Page should contain element    ${season_year_select_path}
    ${default_season_year}    Get selected list label    ${season_year_select_path}    #FALL-2018
    ${default_PlaceHolderStyles_year}    Fetch from right    ${default_season_year}    -
    ${default_PlaceHolderStyles_season}    Fetch from left    ${default_season_year}    -
    Page should contain button    Add New Color
    Click button    Add New Color
    Wait until page does not contain element    ${please_wait_button}
    Wait until page contains    PlaceHolderColorInfo
    Comment    Input    style,season,year,color code and color name
    Input text    name=stylenum    ${style_number}
    Select from list by label    name=seasonid    ${season}
    Select from list by label    name=year    ${year}
    ${color_index}    Set variable    ${0}
    : FOR    ${color_dic}    IN    @{colors_season_year_info}
    \    ${color_code}    Get from dictionary    ${color_dic}    color_code
    \    ${color_name}    Get from dictionary    ${color_dic}    color_name
    \    Input text    //table[@id='mt']/tbody/tr[${color_index+2}]//input[@name='colorcode']    ${color_code}
    \    Input text    //table[@id='mt']/tbody/tr[${color_index+2}]//input[@name='colorname']    ${color_name}
    \    ${color_index}    Evaluate    ${color_index}+1
    Click button    Save Style Info
    Sleep    1
    Wait until page does not contain element    ${please_wait_button}
    Wait until page contains    PlaceHolderStyles    10

Select ph color by search
    [Arguments]    ${ph_style}    ${ph_colors}    ${season_year}
    Select from season and year dropdown    ${season_year}
    Input text    ${ph_search_style_path}    ${ph_style}
    Click button    Search
    Wait until page does not contain element    ${wait_button}
    Table column should contain    css=table.table1    2    ${ph_style}
    ${style_colors_id}    Create list
    :FOR    ${ph_color_info}    IN    @{ph_colors}
    \    ${ph_color}    Get from dictionary    ${ph_color_info}    color_name
    \    ${ph_color_checkbox_xpath}    Set variable    //td[b[text()='${ph_style}']]/parent::tr/following-sibling::tr//td[contains(text(),'${ph_color}')]/preceding-sibling::td/input[@id='phcolorsection']
    \    Select checkbox    ${ph_color_checkbox_xpath}
    \    ${style_color_id}    Get value    ${ph_color_checkbox_xpath}
    \    Append to list    ${style_colors_id}    ${style_color_id}
    [Return]    ${style_colors_id}
